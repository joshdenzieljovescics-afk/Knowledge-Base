<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36" version="29.1.1">
  <diagram name="Document Upload Sequence" id="document-upload-sequence">
    <mxGraphModel dx="1895" dy="1022" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="2000" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="user" parent="1" style="shape=umlActor;verticalLabelPosition=bottom;verticalAlign=top;html=1;" value="User" vertex="1">
          <mxGeometry height="80" width="40" x="80" y="40" as="geometry" />
        </mxCell>
        <mxCell id="frontend" parent="1" style="rounded=1;whiteSpace=wrap;html=1;" value="Frontend&#xa;(React)" vertex="1">
          <mxGeometry height="60" width="100" x="240" y="60" as="geometry" />
        </mxCell>
        <mxCell id="backend" parent="1" style="rounded=1;whiteSpace=wrap;html=1;" value="Backend&#xa;(FastAPI)" vertex="1">
          <mxGeometry height="60" width="100" x="460" y="60" as="geometry" />
        </mxCell>
        <mxCell id="sqlite" parent="1" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;" value="SQLite" vertex="1">
          <mxGeometry height="80" width="80" x="700" y="50" as="geometry" />
        </mxCell>
        <mxCell id="weaviate" parent="1" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;" value="Weaviate" vertex="1">
          <mxGeometry height="80" width="80" x="920" y="50" as="geometry" />
        </mxCell>
        <mxCell id="user-lifeline" edge="1" parent="1" style="endArrow=none;dashed=1;html=1;" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="100" y="1900" as="sourcePoint" />
            <mxPoint x="100" y="140" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="frontend-lifeline" edge="1" parent="1" style="endArrow=none;dashed=1;html=1;" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="290" y="1900" as="sourcePoint" />
            <mxPoint x="290" y="140" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="backend-lifeline" edge="1" parent="1" style="endArrow=none;dashed=1;html=1;" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="510" y="1900" as="sourcePoint" />
            <mxPoint x="510" y="140" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="sqlite-lifeline" edge="1" parent="1" style="endArrow=none;dashed=1;html=1;" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="740" y="1900" as="sourcePoint" />
            <mxPoint x="740" y="140" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="weaviate-lifeline" edge="1" parent="1" style="endArrow=none;dashed=1;html=1;" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="960" y="1900" as="sourcePoint" />
            <mxPoint x="960" y="140" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="msg1" edge="1" parent="1" style="endArrow=classic;html=1;" value="Select PDF">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="100" y="180" as="sourcePoint" />
            <mxPoint x="290" y="180" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="msg2" edge="1" parent="1" style="endArrow=classic;html=1;" value="POST /pdf/parse-pdf&lt;br&gt;(multipart/form-data)">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="290" y="240" as="sourcePoint" />
            <mxPoint x="510" y="240" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="msg3-start" edge="1" parent="1" style="endArrow=classic;html=1;edgeStyle=orthogonalEdgeStyle;" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <Array as="points">
              <mxPoint x="560" y="300" />
            </Array>
            <mxPoint x="510" y="300" as="sourcePoint" />
            <mxPoint x="510" y="350" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="msg3-label" parent="1" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;fontSize=10;" value="Calculate SHA256&lt;br&gt;content_hash" vertex="1">
          <mxGeometry height="30" width="120" x="565" y="310" as="geometry" />
        </mxCell>
        <mxCell id="alt-box" parent="1" style="shape=rect;fillColor=none;strokeColor=#000000;" value="" vertex="1">
          <mxGeometry height="240" width="540" x="460" y="370" as="geometry" />
        </mxCell>
        <mxCell id="alt-label" parent="1" style="text;html=1;align=left;verticalAlign=top;whiteSpace=wrap;fontStyle=1;fontSize=11;fillColor=#f5f5f5;strokeColor=#999999;" value="alt" vertex="1">
          <mxGeometry height="25" width="50" x="460" y="370" as="geometry" />
        </mxCell>
        <mxCell id="alt-divider" edge="1" parent="1" style="endArrow=none;dashed=1;html=1;strokeColor=#999999;" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="460" y="510" as="sourcePoint" />
            <mxPoint x="1000" y="510" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="msg4" edge="1" parent="1" style="endArrow=classic;html=1;" value="SELECT by filename &amp;amp; hash">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="510" y="415" as="sourcePoint" />
            <mxPoint x="740" y="415" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="msg5" edge="1" parent="1" style="endArrow=classic;html=1;dashed=1;" value="Return: no duplicate">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="740" y="460" as="sourcePoint" />
            <mxPoint x="510" y="460" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="msg6-start" edge="1" parent="1" style="endArrow=classic;html=1;edgeStyle=orthogonalEdgeStyle;" value="">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <Array as="points">
              <mxPoint x="560" y="540" />
            </Array>
            <mxPoint x="510" y="540" as="sourcePoint" />
            <mxPoint x="510" y="590" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="msg6-label" parent="1" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;fontSize=10;" value="6. Parse PDF&#xa;Extract &amp;amp; chunk" vertex="1">
          <mxGeometry height="30" width="110" x="565" y="550" as="geometry" />
        </mxCell>
        <mxCell id="msg-conflict" edge="1" parent="1" style="endArrow=classic;html=1;dashed=1;strokeColor=#000000;" value="Return 409 Conflict">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="510" y="570" as="sourcePoint" />
            <mxPoint x="290" y="570" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="msg7" edge="1" parent="1" style="endArrow=classic;html=1;dashed=1;" value="Return: {chunks, document_metadata,&lt;br&gt;content_hash, file_size_bytes}">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="510" y="650" as="sourcePoint" />
            <mxPoint x="290" y="650" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="msg8" edge="1" parent="1" style="endArrow=classic;html=1;dashed=1;" value="Display chunks preview">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="290" y="730" as="sourcePoint" />
            <mxPoint x="100" y="730" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="msg9" edge="1" parent="1" style="endArrow=classic;html=1;" value="Click &quot;Upload to KB&quot;">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="100" y="800" as="sourcePoint" />
            <mxPoint x="290" y="800" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="msg10" edge="1" parent="1" style="endArrow=classic;html=1;" value="POST /kb/upload-to-kb&lt;br&gt;{chunks, metadata, filename,&lt;br&gt;content_hash, file_size_bytes}">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="290" y="880" as="sourcePoint" />
            <mxPoint x="510" y="880" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="msg11" edge="1" parent="1" style="endArrow=classic;html=1;" value="Insert Document &amp;amp; DocumentChunks">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="510" y="980" as="sourcePoint" />
            <mxPoint x="960" y="980" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="msg12" edge="1" parent="1" style="endArrow=classic;html=1;dashed=1;" value="Return: weaviate_doc_id">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="960" y="1040" as="sourcePoint" />
            <mxPoint x="510" y="1040" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="msg13" edge="1" parent="1" style="endArrow=classic;html=1;" value="INSERT INTO documents">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="510" y="1110" as="sourcePoint" />
            <mxPoint x="740" y="1110" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="msg14" edge="1" parent="1" style="endArrow=classic;html=1;dashed=1;" value="Return: success">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="740" y="1170" as="sourcePoint" />
            <mxPoint x="510" y="1170" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="msg15" edge="1" parent="1" style="endArrow=classic;html=1;dashed=1;" value="Return: {success, doc_id,&lt;br&gt;weaviate_doc_id, action, version}">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="510" y="1230" as="sourcePoint" />
            <mxPoint x="290" y="1230" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="msg16" edge="1" parent="1" style="endArrow=classic;html=1;dashed=1;" value="Show Success Modal">
          <mxGeometry height="50" relative="1" width="50" as="geometry">
            <mxPoint x="290" y="1270" as="sourcePoint" />
            <mxPoint x="100" y="1270" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="tBWaOMfVbSYDcvmLIhEG-1" parent="1" style="shape=umlFrame;whiteSpace=wrap;html=1;pointerEvents=0;" value="&lt;b&gt;alt&lt;/b&gt;" vertex="1">
          <mxGeometry height="240" width="540" x="460" y="370" as="geometry" />
        </mxCell>
        <mxCell id="tBWaOMfVbSYDcvmLIhEG-2" parent="1" style="shape=umlFrame;whiteSpace=wrap;html=1;pointerEvents=0;" value="opt" vertex="1">
          <mxGeometry height="590" width="980" x="30" y="690" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
